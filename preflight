#!/bin/sh
# Script for calling multiple routines on a project, typically prior to committing to a repository.

echo "Updating glyph orders in Regular..."
# setting both to the same order
psfsetglyphorder -q -p checkfix=none --gname GlyphsName --header DesignerOrder,DesignerOrder --field public.glyphOrder,com.schriftgestaltung.glyphOrder -i source/glyphInfo.csv source/*-Regular.ufo

echo "Updating production names in Regular..."
psfsetpsnames -q -p checkfix=none --gname GlyphsName -i source/glyphInfo.csv source/Harmattan-Regular.ufo

echo "Syncing glyph orders, psnames, and other metadata to other UFOs..."
psfsyncmasters source/Harmattan-RB.designspace

echo "Final check and normalize..."
psfnormalize -p checkfix=fix source/Harmattan-Regular.ufo
psfnormalize -p checkfix=fix source/Harmattan-Bold.ufo

echo "Updating woff metadata file..."
psfmakewoffmetadata -q -n Harmattan -i org.sil.fonts source/*-Regular.ufo

echo "preflight completed!"
